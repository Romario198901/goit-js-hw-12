{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst instance = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  timeout: 1000,\n});\nexport async function getImagesByQuery(query, page) {\n  try {\n    const response = await instance.get('/', {\n      params: {\n        key: '53360432-3950dd890aa8264617696b589',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: 15,\n      },\n    });\n    const { hits, totalHits } = response.data;\n    return { hits, totalHits };\n  } catch (error) {\n    console.error(error);\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst simplelightbox = new SimpleLightbox('.gallery-link', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 500,\n});\nexport const refs = {\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-btn'),\n};\nfunction createCard({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-item\">\n<a href=\"${largeImageURL}\" class=\"gallery-link\">\n<img src=\"${webformatURL}\" alt=\"${tags}\">\n</a>\n<div class=\"gallery-descr\">\n<div class=\"gallery-descr-item\">\n<p class=\"gallery-descr-title\">Likes</p>\n<p class=\"gallery-descr-value\">${likes}</p>\n</div>\n<div class=\"gallery-descr-item\">\n<p class=\"gallery-descr-title\">Views</p>\n<p class=\"gallery-descr-value\">${views}</p>\n</div>\n<div class=\"gallery-descr-item\">\n<p class=\"gallery-descr-title\">Comments</p>\n<p class=\"gallery-descr-value\">${comments}</p>\n</div>\n<div class=\"gallery-descr-item\">\n<p class=\"gallery-descr-title\">Downloads</p>\n<p class=\"gallery-descr-value\">${downloads}</p>\n</div>\n</div>\n</li>`;\n}\nexport function createGallery(images) {\n  const markup = images.map(createCard).join('');\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n  simplelightbox.refresh();\n}\nexport function clearGallery() {\n  refs.gallery.innerHTML = '';\n}\nexport function showLoader() {\n  refs.loader.classList.remove('is-hidden');\n}\nexport function hideLoader() {\n  refs.loader.classList.add('is-hidden');\n}\nexport function showLoadMoreButton() {\n  refs.loadMoreBtn.classList.remove('is-hidden');\n}\nexport function hideLoadMoreButton() {\n  refs.loadMoreBtn.classList.add('is-hidden');\n}\n","import iziToast from 'izitoast';\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  clearGallery,\n  createGallery,\n  hideLoader,\n  hideLoadMoreButton,\n  refs,\n  showLoader,\n  showLoadMoreButton,\n} from './js/render-functions';\nconst searchForm = document.querySelector('form');\nlet currentPage;\nlet currentQuery = '';\nlet total = 0;\nconst ITEMS_PER_PAGE = 15;\nsearchForm.addEventListener('submit', handleFormSubmit);\nasync function handleFormSubmit(e) {\n  e.preventDefault();\n  const formData = new FormData(e.target);\n  const query = formData.get('search-text').trim();\n  if (!query) {\n    iziToast.warning({\n      title: '❌',\n      titleColor: '#fafafb',\n      message: ` Please enter search query!`,\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n    return;\n  }\n  clearGallery();\n  showLoader();\n  currentPage = 1;\n  currentQuery = query;\n  try {\n    const { hits, totalHits } = await getImagesByQuery(\n      currentQuery,\n      currentPage\n    );\n    total = totalHits;\n    const totalPages = Math.ceil(total / ITEMS_PER_PAGE);\n    if (!hits || hits.length === 0) {\n      iziToast.error({\n        title: '❌',\n        titleColor: '#fafafb',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        messageColor: '#fafafb',\n        backgroundColor: '#ef4040',\n        position: 'topRight',\n      });\n      return;\n    }\n    createGallery(hits);\n    if (currentPage < totalPages) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n    }\n  } catch (error) {\n    iziToast.error({\n      title: '❌',\n      titleColor: '#fafafb',\n      message: `Sorry, something went wrong!!!. Please try again!`,\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n    console.error(error);\n  } finally {\n    hideLoader();\n    e.target.reset();\n  }\n}\nclearGallery();\nrefs.loadMoreBtn.addEventListener('click', handleLoadMoreBtnClicked);\nasync function handleLoadMoreBtnClicked() {\n  showLoader();\n  try {\n    const totalPages = Math.ceil(total / ITEMS_PER_PAGE);\n    if (currentPage + 1 >= totalPages) {\n      iziToast.warning({\n        title: '❌',\n        titleColor: '#fafafb',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageColor: '#fafafb',\n        backgroundColor: '#ef4040',\n        position: 'bottomRight',\n      });\n      hideLoadMoreButton();\n      return;\n    }\n    const nextPage = currentPage + 1;\n    const { hits } = await getImagesByQuery(currentQuery, nextPage);\n    if (!hits || hits.length === 0) {\n      iziToast.warning({\n        title: '❌',\n        titleColor: '#fafafb',\n        message: 'No more images found.',\n        messageColor: '#fafafb',\n        backgroundColor: '#ef4040',\n        position: 'bottomRight',\n      });\n      hideLoadMoreButton();\n      return;\n    }\n    currentPage = nextPage;\n    createGallery(hits);\n    const cardHeight =\n      refs.gallery.firstElementChild.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n    if (currentPage >= totalPages) {\n      hideLoadMoreButton();\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    iziToast.error({\n      title: '❌',\n      titleColor: '#fafafb',\n      message: 'Sorry, something went wrong!!!. Please try again!',\n      messageColor: '#fafafb',\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n  }\n}\n"],"names":["instance","axios","getImagesByQuery","query","page","response","hits","totalHits","error","simplelightbox","SimpleLightbox","refs","createCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","createGallery","images","markup","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","searchForm","currentPage","currentQuery","total","ITEMS_PER_PAGE","handleFormSubmit","e","iziToast","totalPages","handleLoadMoreBtnClicked","nextPage","cardHeight"],"mappings":"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"}